---
import { NAV_LINKS, LOGO_SVG } from "../const";
---

<header class="sticky top-0 z-40 w-full glass h-16">
  <div class="container mx-auto px-4 h-16 flex items-center justify-between">
    <a
      href="/"
      class="flex items-center gap-2 group h-10"
      aria-label="Scorpio Tech - Home"
    >
      <span class="logo w-8 h-8 shrink-0" aria-hidden="true">
        <Fragment set:html={LOGO_SVG} />
      </span>
      <span
        class="brand-text font-bold text-xl tracking-tight text-white group-hover:text-blue-400 transition-colors"
        >Scorpio</span
      >
    </a>

    <!-- Desktop Nav -->
    <nav class="hidden md:flex items-center gap-8" aria-label="Main navigation">
      {
        NAV_LINKS.map((link) => (
          <a
            href={link.href}
            class="text-m font-medium text-slate-300 hover:text-white focus:ring-2 focus:ring-blue-400 focus:outline-none rounded px-2 py-1 transition-colors"
          >
            {link.label}
          </a>
        ))
      }
    </nav>

    <!-- Mobile Menu Button -->
    <button
      id="mobile-menu-btn"
      class="md:hidden p-2 text-slate-400 hover:text-white focus:ring-2 focus:ring-blue-400 focus:outline-none rounded transition-colors"
      aria-label="Toggle navigation menu"
      aria-expanded="false"
      aria-controls="mobile-menu"
    >
      <svg
        class="w-6 h-6"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
        aria-hidden="true"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M4 6h16M4 12h16m-7 6h7"></path>
      </svg>
    </button>
  </div>

  <!-- Mobile Nav -->
  <div
    id="mobile-menu"
    class="hidden md:hidden absolute top-16 left-0 w-full bg-[#15151a] border-b border-zinc-800 p-4 shadow-xl"
  >
    <nav class="flex flex-col gap-4" aria-label="Mobile navigation">
      {
        NAV_LINKS.map((link) => (
          <a
            href={link.href}
            class="text-lg font-medium text-slate-300 hover:text-white focus:ring-2 focus:ring-blue-400 focus:outline-none rounded px-2 py-2 transition-colors block"
          >
            {link.label}
          </a>
        ))
      }
    </nav>
  </div>
</header>

<script>
  const btn = document.getElementById("mobile-menu-btn") as HTMLButtonElement;
  const menu = document.getElementById("mobile-menu");

  btn?.addEventListener("click", () => {
    const isExpanded = btn.getAttribute("aria-expanded") === "true";
    btn.setAttribute("aria-expanded", String(!isExpanded));
    menu?.classList.toggle("hidden");
  });

  // Close menu when a link is clicked
  menu?.querySelectorAll("a").forEach((link) => {
    link.addEventListener("click", () => {
      btn.setAttribute("aria-expanded", "false");
      menu?.classList.add("hidden");
    });
  });

  // Close menu on Escape key
  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape" && !menu?.classList.contains("hidden")) {
      btn.setAttribute("aria-expanded", "false");
      menu?.classList.add("hidden");
      btn?.focus();
    }
  });
</script>

<style>
  .logo svg {
    display: block;
    width: 32px;
    height: 32px;
  }
  header {
    min-height: 64px;
  }
  .logo {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
  }
  .brand-text {
    display: inline-block;
    width: 9rem;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
</style>
