---
// BarWeight.astro
import CalcCard from "../CalcCard.astro";
import CalcInput from "../CalcInput.astro";
import CalcOutput from "../CalcOutput.astro";
---

<CalcCard title="Bar Weight Calculator" badge="Metal.v1">
  <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
    <CalcInput id="rod_diameter" label="Diameter" value="16" unit="mm" />
    <CalcInput id="rod_length" label="Length" value="330" unit="mm" />
    <CalcInput
      id="rod_density"
      label="Density"
      value="14.8"
      step="0.01"
      unit="g/cmÂ³"
    />
  </div>

  <div class="pt-4 border-t border-zinc-800/30">
    <CalcOutput id="rod_weight_out" label="Estimated mass" unit="g" value="0" />
  </div>
</CalcCard>

<script>
  const d = document.getElementById("rod_diameter") as HTMLInputElement;
  const L = document.getElementById("rod_length") as HTMLInputElement;
  const rho = document.getElementById("rod_density") as HTMLInputElement;
  const out = document.getElementById("rod_weight_out") as HTMLElement;

  function calc() {
    const diam = parseFloat(d.value) || 0;
    const len = parseFloat(L.value) || 0;
    const density = parseFloat(rho.value) || 0;

    // Convert mm -> cm for volume (1 cm = 10 mm)
    const r_cm = diam / 2 / 10;
    const L_cm = len / 10;
    const vol = Math.PI * Math.pow(r_cm, 2) * L_cm; // cm^3
    const mass = vol * density; // g

    out.textContent = `${mass.toFixed(1)}`;
  }

  [d, L, rho].forEach((el) => el?.addEventListener("input", calc));
  calc();
</script>
