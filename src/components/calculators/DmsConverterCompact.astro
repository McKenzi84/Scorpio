---
// DMS Converter (Compact)
---

<div
  class="glass p-4 rounded-lg w-full max-w-lg mx-auto shadow-md"
  role="region"
  aria-labelledby="dms-compact-title"
>
  <div class="flex items-center justify-between mb-3">
    <h3 id="dms-compact-title" class="text-lg font-semibold text-white">
      DMS Converter — Compact (Readable)
    </h3>
    <div
      class="text-[10px] font-mono text-blue-400 uppercase bg-blue-500/8 px-2 py-0.5 rounded"
    >
      Angle.v1
    </div>
  </div>

  <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 items-start">
    <div>
      <label
        for="decimal-input-compact"
        class="block text-sm font-medium text-slate-200 mb-1"
        >Decimal degrees</label
      >
      <input
        id="decimal-input-compact"
        type="number"
        step="any"
        aria-describedby="decimal-desc-compact"
        class="w-full px-3 py-2 rounded-md bg-zinc-900 border border-zinc-800 focus:border-blue-500 text-slate-100 text-base font-medium"
        value="0"
      />
      <p id="decimal-desc-compact" class="text-xs text-slate-400 mt-1">
        Enter decimal degrees (e.g., 45.5)
      </p>
    </div>

    <div>
      <div class="grid grid-cols-3 gap-2">
        <div>
          <label
            for="dms-deg-compact"
            class="block text-sm font-medium text-slate-200 mb-1"
            >Degrees (°)</label
          >
          <input
            id="dms-deg-compact"
            type="number"
            class="w-full px-2 py-2 rounded-md bg-zinc-900 border border-zinc-800 text-slate-100 text-center text-base font-medium"
            value="0"
          />
        </div>
        <div>
          <label
            for="dms-min-compact"
            class="block text-sm font-medium text-slate-200 mb-1"
            >Minutes (′)</label
          >
          <input
            id="dms-min-compact"
            type="number"
            class="w-full px-2 py-2 rounded-md bg-zinc-900 border border-zinc-800 text-slate-100 text-center text-base font-medium"
            value="0"
          />
        </div>
        <div>
          <label
            for="dms-sec-compact"
            class="block text-sm font-medium text-slate-200 mb-1"
            >Seconds (″)</label
          >
          <input
            id="dms-sec-compact"
            type="number"
            step="any"
            class="w-full px-2 py-2 rounded-md bg-zinc-900 border border-zinc-800 text-slate-100 text-center text-base font-medium"
            value="0"
          />
        </div>
      </div>

      <div class="mt-3 flex items-center justify-between">
        <div class="text-sm text-slate-300">
          Result: <strong id="dec-result" class="text-white">0.000000</strong>
        </div>
        <div class="text-sm text-slate-400">Live sync</div>
      </div>
    </div>
  </div>
</div>

<script>
  const decimalInput = document.getElementById("decimal-input-compact");
  const degInput = document.getElementById("dms-deg-compact");
  const minInput = document.getElementById("dms-min-compact");
  const secInput = document.getElementById("dms-sec-compact");
  const decResult = document.getElementById("dec-result");

  function convertDecToDms(val) {
    const absDec = Math.abs(val);
    const d = Math.floor(absDec);
    const m = Math.floor((absDec - d) * 60);
    const s = ((absDec - d - m / 60) * 3600).toFixed(2);
    return {
      d: (val < 0 ? -d : d).toString(),
      m: m.toString(),
      s: s,
    };
  }

  function convertDmsToDec(d, m, s) {
    const sign = d < 0 ? -1 : 1;
    const res = (Math.abs(d) + m / 60 + s / 3600) * sign;
    return res.toFixed(6);
  }

  function updateFromDecimal() {
    const val = parseFloat(decimalInput.value) || 0;
    const dms = convertDecToDms(val);
    if (degInput) degInput.value = dms.d;
    if (minInput) minInput.value = dms.m;
    if (secInput) secInput.value = dms.s;
    if (decResult) decResult.textContent = parseFloat(val).toFixed(6);
  }

  function updateFromDms() {
    const d = parseFloat(degInput.value) || 0;
    const m = parseFloat(minInput.value) || 0;
    const s = parseFloat(secInput.value) || 0;
    const dec = convertDmsToDec(d, m, s);
    if (decimalInput) decimalInput.value = dec;
    if (decResult) decResult.textContent = parseFloat(dec).toFixed(6);
  }

  decimalInput?.addEventListener("input", updateFromDecimal);
  [degInput, minInput, secInput].forEach((input) =>
    input?.addEventListener("input", updateFromDms),
  );

  // initialize values
  updateFromDecimal();
</script>
