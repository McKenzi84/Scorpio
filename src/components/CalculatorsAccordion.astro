---
// CalculatorsAccordion.astro - Loads calculators calculator folder
const calculatorModules = import.meta.glob("./calculators/*.astro");

// Build items array from all files in the calculators directory
const items = await Promise.all(
  Object.entries(calculatorModules)
    .filter(([path]) => !path.includes("TestCalc.astro"))
    .map(async ([path, load]) => {
      const filename = path.split("/").pop()?.replace(".astro", "") || "";
      const title = filename.replace(/([A-Z])/g, " $1").trim();

      const mod: any = await load();
      return {
        title,
        component: mod.default,
      };
    }),
);
---

<section class="calc-card p-0" aria-label="Calculator tools">
  {
    items.map((item, index) => (
      <details class="group border-b border-zinc-800 last:border-b-0 ">
        <summary class="py-6 px-4 flex items-center justify-between cursor-pointer transition-colors hover:bg-zinc-900/60 group-open:bg-zinc-800 focus:outline-none">
          <span class="text-lg font-bold tracking-tight transition-colors text-slate-100 group-hover:text-white group-open:text-brand-blue">
            {item.title}
          </span>
          <svg
            class="w-5 h-5 transition-transform duration-300 text-zinc-600 group-open:rotate-180 group-open:text-brand-blue shrink-0 ml-2"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            aria-hidden="true"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M19 9l-7 7-7-7"
            />
          </svg>
        </summary>
        <div class="px-4 pb-4 border-t border-zinc-800/30 pt-2 bg-gray-100">
          <item.component />
        </div>
      </details>
    ))
  }
</section>
